{"ast":null,"code":"import axios from \"axios\";\nimport swal from \"sweetalert2\";\nimport liff from \"@line/liff\";\nimport popup from \"../components/popup\";\nimport store from \"../store/tags\";\nexport default {\n  name: \"friendPage\",\n  components: {\n    popup\n  },\n  props: [\"userInfo\", 'setShareFinishType'],\n  data() {\n    return {\n      dialog: false,\n      popupIconType: \"\",\n      popupItem: \"\",\n      prize: \"\",\n      shareFinish: false,\n      canSendTime: \"\",\n      shareMsgSuccess: false\n    };\n  },\n  computed: {\n    friendTags() {\n      //愛酷標籤\n      return store.state.friendTags;\n    }\n  },\n  methods: {\n    // 邀請line好友\n    shareMsg() {\n      var me = this;\n      const oaUrl = me.$liffUrl + '?v=' + new Date().getTime();\n      if (!liff.isApiAvailable(\"shareTargetPicker\")) {\n        swal.fire({\n          icon: \"error\",\n          title: \"您的Line版本不支援此功能\",\n          text: \"請嘗試更新Line app後，再次使用此功能\"\n        });\n      } else {\n        // swal.fire({\n        //   allowOutsideClick: false,\n        // });\n        // swal.showLoading();\n        liff.shareTargetPicker([{\n          type: \"text\",\n          text: \"現在加入並成功邀請好友最高可抽LINE POINTS 80點🥰🥰\\n\\n【🌸花見好生活 春風貓陪你野餐賞櫻趣🐱】\\n 📆 即日起至2023/04/20止\\n📍邀請好友加入春風，每成功邀請1位送10點LINE POINTS，最高30點~（每人限領一次，共400名）\\n 📍成功邀請3位，加碼抽50點！（共80名）\\n\\n 🛒活動期間內，單筆購買春風全系列商品滿168元，再抽iPad等多項好禮！\\n\\n👇點擊下方圖片立即加入👇\",\n          wrap: true\n        }, {\n          type: \"flex\",\n          altText: \"春風貓好好生活節，現在加入並成功邀請好友，送免費LINE POINTS\",\n          contents: {\n            type: \"bubble\",\n            size: \"giga\",\n            hero: {\n              type: \"image\",\n              url: me.$apiUrl + \"/sharing1.jpg?v=\" + new Date().getTime(),\n              size: \"full\",\n              aspectRatio: \"1:1\",\n              aspectMode: \"cover\",\n              action: {\n                type: \"uri\",\n                uri: `${oaUrl}?inviteCode=${this.userInfo.inviteCode}#`\n              }\n            }\n          }\n        }]).then(function (res) {\n          if (res) {\n            // succeeded in sending a message through TargetPicker\n            // console.log(`[${res.status}] Message sent!`)\n            me.shareMsgSuccess = true;\n          } else {\n            const [majorVer, minorVer] = (liff.getLineVersion() || \"\").split(\".\");\n            if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {\n              // LINE 10.3.0 - 10.10.0\n              // Old LINE will access here regardless of user's action\n              // TargetPicker 至少已打開。是否成功發送消息不清楚\n              me.shareMsgSuccess = true;\n            } else {\n              // LINE 10.11.0 -\n              // sending message canceled\n              // console.log('TargetPicker was closed!')\n              // 取消分享\n              me.shareMsgSuccess = false;\n            }\n          }\n          if (me.shareMsgSuccess) {\n            // 已成功分享好友訊息\n            me.shareFinish = true;\n            // this.$emit('shareFinishType', this.shareFinish)\n          } else {\n            // user取消分享\n            // alert(\"\")\n          }\n        }).catch(function (error) {\n          // something went wrong before sending a message\n          console.log(error);\n          alert(\"系統忙碌中，請稍後再試 !!\");\n        }).finally(() => {\n          // swal.close();\n        });\n      }\n    },\n    // 取得驗證碼的倒數秒數\n    getCanSendTime() {\n      var me = this;\n      me.url = \"/Liff/GetData_SmsCanSendTime/54CF6E71502D44198838C6C21DA43F0A\";\n      var config = {\n        method: \"get\",\n        headers: {\n          Authorization: `Bearer ${me.$accessToken}`\n        },\n        url: me.$apiUrl + me.url\n      };\n      swal.fire({\n        didOpen: () => {\n          swal.fire({\n            allowOutsideClick: false\n          });\n          swal.showLoading();\n          axios(config).then(res => {\n            var data = res.data;\n            if (data && data.success) {\n              // 剩餘秒數\n              me.canSendTime = data.data;\n            }\n          }).catch(err => {\n            console.log(err);\n            alert(\"系統忙碌中，請稍後再試\");\n          }).finally(() => {\n            swal.close();\n          });\n        }\n      });\n    },\n    seePopUp(val) {\n      this.dialog = true;\n      this.popupIconType = \"icon\" + val;\n      this.popupItem = val;\n    },\n    changeAeMember() {\n      this.$emit(\"changeAeMember\", true);\n    }\n  }\n};","map":{"version":3,"names":["axios","swal","liff","popup","store","name","components","props","data","dialog","popupIconType","popupItem","prize","shareFinish","canSendTime","shareMsgSuccess","computed","friendTags","state","methods","shareMsg","me","oaUrl","$liffUrl","Date","getTime","isApiAvailable","fire","icon","title","text","shareTargetPicker","type","wrap","altText","contents","size","hero","url","$apiUrl","aspectRatio","aspectMode","action","uri","userInfo","inviteCode","then","res","majorVer","minorVer","getLineVersion","split","parseInt","catch","error","console","log","alert","finally","getCanSendTime","config","method","headers","Authorization","$accessToken","didOpen","allowOutsideClick","showLoading","success","err","close","seePopUp","val","changeAeMember","$emit"],"sources":["src/views/friendPage.vue"],"sourcesContent":["<template>\n  <div class=\"friendPage animate__animated animate__fadeInUp animate__slow\">\n    <div class=\"txtBox\" v-if=\"!shareFinish\">\n      <!-- 邀請好友 -->\n      <img\n        src=\"@/assets/img/friend/txt0.jpg\"\n        @load=\"$emit('getLoading', false)\"\n      />\n      <img\n        src=\"../assets/img/friend/txt1.png\"\n        @click=\"\n          shareMsg();\n          $addTags(friendTags.shareMsg, null, null, null);\n        \"\n      />\n    </div>\n    <div class=\"txtBox\" v-else>\n      <!-- 已經邀請好友 -->\n      <img\n        src=\"../assets/img/friend/txt2.jpg\"\n        @load=\"$emit('getLoading', false)\"\n      />\n      <img\n        src=\"../assets/img/friend/goHome.png\"\n        @click=\"$addTags(friendTags.goHome, null, null, { path: '/' })\"\n      />\n      <!--<router-link to=\"/fromPage\"><img src=\"../assets/img/friend/goHome.png\"></router-link>-->\n    </div>\n    <popup\n      :popupIconType=\"popupIconType\"\n      :popupItem=\"popupItem\"\n      :prize=\"prize\"\n      :canSendTime=\"canSendTime\"\n      v-if=\"dialog\"\n      @popupStatus=\"(dialog = false), (shareFinish = true)\"\n      @changeAeMember=\"changeAeMember\"\n    />\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport swal from \"sweetalert2\";\nimport liff from \"@line/liff\";\nimport popup from \"../components/popup\";\nimport store from \"../store/tags\";\nexport default {\n  name: \"friendPage\",\n  components: {\n    popup,\n  },\n  props: [\"userInfo\",'setShareFinishType'],\n  data() {\n    return {\n      dialog: false,\n      popupIconType: \"\",\n      popupItem: \"\",\n      prize: \"\",\n      shareFinish: false,\n      canSendTime: \"\",\n      shareMsgSuccess: false,\n    };\n  },\n  computed: {\n    friendTags() {\n      //愛酷標籤\n      return store.state.friendTags;\n    },\n  },\n  methods: {\n    // 邀請line好友\n    shareMsg() {\n      var me = this;\n      const oaUrl = me.$liffUrl + '?v='+new Date().getTime();\n      if (!liff.isApiAvailable(\"shareTargetPicker\")) {\n        swal.fire({\n          icon: \"error\",\n          title: \"您的Line版本不支援此功能\",\n          text: \"請嘗試更新Line app後，再次使用此功能\",\n        });\n      } else {\n        // swal.fire({\n        //   allowOutsideClick: false,\n        // });\n        // swal.showLoading();\n        liff\n          .shareTargetPicker([\n            {\n              type: \"text\",\n              text: \"現在加入並成功邀請好友最高可抽LINE POINTS 80點🥰🥰\\n\\n【🌸花見好生活 春風貓陪你野餐賞櫻趣🐱】\\n 📆 即日起至2023/04/20止\\n📍邀請好友加入春風，每成功邀請1位送10點LINE POINTS，最高30點~（每人限領一次，共400名）\\n 📍成功邀請3位，加碼抽50點！（共80名）\\n\\n 🛒活動期間內，單筆購買春風全系列商品滿168元，再抽iPad等多項好禮！\\n\\n👇點擊下方圖片立即加入👇\",\n              wrap: true,\n            },\n            {\n              type: \"flex\",\n              altText:\n                \"春風貓好好生活節，現在加入並成功邀請好友，送免費LINE POINTS\",\n              contents: {\n                type: \"bubble\",\n                size: \"giga\",\n                hero: {\n                  type: \"image\",\n                  url: me.$apiUrl + \"/sharing1.jpg?v=\"+new Date().getTime(),\n                  size: \"full\",\n                  aspectRatio: \"1:1\",\n                  aspectMode: \"cover\",\n                  action: {\n                    type: \"uri\",\n                    uri: `${oaUrl}?inviteCode=${this.userInfo.inviteCode}#`,\n                  },\n                },\n              },\n            },\n          ])\n          .then(function (res) {\n            if (res) {\n              // succeeded in sending a message through TargetPicker\n              // console.log(`[${res.status}] Message sent!`)\n              me.shareMsgSuccess = true;\n            } else {\n              const [majorVer, minorVer] = (liff.getLineVersion() || \"\").split(\n                \".\"\n              );\n              if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {\n                // LINE 10.3.0 - 10.10.0\n                // Old LINE will access here regardless of user's action\n                // TargetPicker 至少已打開。是否成功發送消息不清楚\n                me.shareMsgSuccess = true;\n              } else {\n                // LINE 10.11.0 -\n                // sending message canceled\n                // console.log('TargetPicker was closed!')\n                // 取消分享\n                me.shareMsgSuccess = false;\n              }\n            }\n\n            if (me.shareMsgSuccess) {\n              // 已成功分享好友訊息\n              me.shareFinish = true;\n              // this.$emit('shareFinishType', this.shareFinish)\n            } else {\n              // user取消分享\n              // alert(\"\")\n            }\n          })\n          .catch(function (error) {\n            // something went wrong before sending a message\n            console.log(error);\n            alert(\"系統忙碌中，請稍後再試 !!\");\n          })\n          .finally(() => {\n            // swal.close();\n          });\n      }\n    },\n    // 取得驗證碼的倒數秒數\n    getCanSendTime() {\n      var me = this;\n      me.url = \"/Liff/GetData_SmsCanSendTime/54CF6E71502D44198838C6C21DA43F0A\";\n      var config = {\n        method: \"get\",\n        headers: {\n          Authorization: `Bearer ${me.$accessToken}`,\n        },\n        url: me.$apiUrl + me.url,\n      };\n      swal.fire({\n        didOpen: () => {\n          swal.fire({\n            allowOutsideClick: false,\n          });\n          swal.showLoading();\n          axios(config)\n            .then((res) => {\n              var data = res.data;\n              if (data && data.success) {\n                // 剩餘秒數\n                me.canSendTime = data.data;\n              }\n            })\n            .catch((err) => {\n              console.log(err);\n              alert(\"系統忙碌中，請稍後再試\");\n            })\n            .finally(() => {\n              swal.close();\n            });\n        },\n      });\n    },\n    seePopUp(val) {\n      this.dialog = true;\n      this.popupIconType = \"icon\" + val;\n      this.popupItem = val;\n    },\n    changeAeMember() {\n      this.$emit(\"changeAeMember\", true);\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.friendPage {\n  min-height: calc(100vh - 56px);\n  background-size: cover;\n  background-position: center;\n  background-image: url(../assets/img/friend/bg.jpg);\n  display: flex;\n\n  .txtBox {\n    width: 100vw;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n\n    img {\n      &:nth-child(-n + 2) {\n        width: 100%;\n      }\n    }\n  }\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}