{"ast":null,"code":"import axios from \"axios\";\nimport swal from \"sweetalert2\";\nimport liff from \"@line/liff\";\nimport popup from \"../components/popup\";\nimport store from \"../store/tags\";\nexport default {\n  name: \"friendPage\",\n  components: {\n    popup\n  },\n  props: [\"userInfo\", 'setShareFinishType'],\n  data() {\n    return {\n      dialog: false,\n      popupIconType: \"\",\n      popupItem: \"\",\n      prize: \"\",\n      shareFinish: false,\n      canSendTime: \"\",\n      shareMsgSuccess: false\n    };\n  },\n  computed: {\n    friendTags() {\n      //愛酷標籤\n      return store.state.friendTags;\n    }\n  },\n  methods: {\n    // 邀請line好友\n    shareMsg() {\n      var me = this;\n      const oaUrl = me.$liffUrl + '?v=' + new Date().getTime();\n      if (!liff.isApiAvailable(\"shareTargetPicker\")) {\n        swal.fire({\n          icon: \"error\",\n          title: \"您的Line版本不支援此功能\",\n          text: \"請嘗試更新Line app後，再次使用此功能\"\n        });\n      } else {\n        // swal.fire({\n        //   allowOutsideClick: false,\n        // });\n        // swal.showLoading();\n        liff.shareTargetPicker([{\n          type: \"text\",\n          text: \"現在加入並成功邀請好友最高可抽LINE POINTS 80點🥰🥰\\n\\n【🌸花見好生活 春風貓陪你野餐賞櫻趣🐱】\\n 📆 即日起至2023/04/20止\\n📍邀請好友加入春風，每成功邀請1位送10點LINE POINTS，最高30點~（每人限領一次，共400名）\\n 📍成功邀請3位，加碼抽50點！（共80名）\\n\\n 🛒活動期間內，單筆購買春風全系列商品滿168元，再抽iPad等多項好禮！\\n\\n👇點擊下方圖片立即加入👇\",\n          wrap: true\n        }, {\n          type: \"flex\",\n          altText: \"春風貓好好生活節，現在加入並成功邀請好友，送免費LINE POINTS\",\n          contents: {\n            type: \"bubble\",\n            size: \"giga\",\n            hero: {\n              type: \"image\",\n              url: me.$apiUrl + \"/sharing1.jpg?v=\" + new Date().getTime(),\n              size: \"full\",\n              aspectRatio: \"1:1\",\n              aspectMode: \"cover\",\n              action: {\n                type: \"uri\",\n                uri: `${oaUrl}?inviteCode=${this.userInfo.inviteCode}#`\n              }\n            }\n          }\n        }]).then(function (res) {\n          if (res) {\n            // succeeded in sending a message through TargetPicker\n            // console.log(`[${res.status}] Message sent!`)\n            me.shareMsgSuccess = true;\n          } else {\n            const [majorVer, minorVer] = (liff.getLineVersion() || \"\").split(\".\");\n            if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {\n              // LINE 10.3.0 - 10.10.0\n              // Old LINE will access here regardless of user's action\n              // TargetPicker 至少已打開。是否成功發送消息不清楚\n              me.shareMsgSuccess = true;\n            } else {\n              // LINE 10.11.0 -\n              // sending message canceled\n              // console.log('TargetPicker was closed!')\n              // 取消分享\n              me.shareMsgSuccess = false;\n            }\n          }\n          if (me.shareMsgSuccess) {\n            // 已成功分享好友訊息\n            me.shareFinish = true;\n            this.$emit('shareFinishType', this.shareFinish);\n          } else {\n            // user取消分享\n            // alert(\"\")\n          }\n        }).catch(function (error) {\n          // something went wrong before sending a message\n          console.log(error);\n          alert(\"系統忙碌中，請稍後再試 !!\");\n        }).finally(() => {\n          // swal.close();\n        });\n      }\n    },\n    // 取得驗證碼的倒數秒數\n    getCanSendTime() {\n      var me = this;\n      me.url = \"/Liff/GetData_SmsCanSendTime/54CF6E71502D44198838C6C21DA43F0A\";\n      var config = {\n        method: \"get\",\n        headers: {\n          Authorization: `Bearer ${me.$accessToken}`\n        },\n        url: me.$apiUrl + me.url\n      };\n      swal.fire({\n        didOpen: () => {\n          swal.fire({\n            allowOutsideClick: false\n          });\n          swal.showLoading();\n          axios(config).then(res => {\n            var data = res.data;\n            if (data && data.success) {\n              // 剩餘秒數\n              me.canSendTime = data.data;\n            }\n          }).catch(err => {\n            console.log(err);\n            alert(\"系統忙碌中，請稍後再試\");\n          }).finally(() => {\n            swal.close();\n          });\n        }\n      });\n    },\n    seePopUp(val) {\n      this.dialog = true;\n      this.popupIconType = \"icon\" + val;\n      this.popupItem = val;\n    },\n    changeAeMember() {\n      this.$emit(\"changeAeMember\", true);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}