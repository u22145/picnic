{"ast":null,"code":"import axios from \"axios\";\nimport swal from 'sweetalert2';\nimport googleRecapcha from '@/components/googleRecapcha.vue';\nimport popup from '../components/popup';\nimport fromComponents from '../components/fromComponents';\nimport store from '../store/tags';\nexport default {\n  name: 'fromPage',\n  components: {\n    popup,\n    googleRecapcha,\n    fromComponents\n  },\n  props: [],\n  data() {\n    return {\n      isActive: '',\n      tab: null,\n      parentInv_number: '',\n      items: ['電子發票', '傳統發票'],\n      cloudInvoice: '1',\n      //1=手動 ,2=載具 ,3=掃描\n      form: '',\n      gCAPTCHA_token: '',\n      dialog: false,\n      popupIconType: '',\n      popupItem: '',\n      prize: '',\n      inv_number: ''\n    };\n  },\n  computed: {\n    fromTags() {\n      //愛酷標籤\n      return store.state.fromTags;\n    }\n  },\n  methods: {\n    // 顯示popup視窗\n    seePopUp(val, data) {\n      this.dialog = true;\n      this.popupIconType = 'icon' + val;\n      this.popupItem = val;\n      this.isDraw = data.isDraw;\n      this.inv_number = data.inv_number;\n    },\n    // 拿到子層資料\n    getParentData(val) {\n      console.log('拿到子層資料', val);\n      this.form = val;\n      this.googleVerify();\n    },\n    // 打googleRecapcha\n    googleVerify() {\n      this.$refs.googleRecapcha.execute();\n    },\n    // 獲得googleRecapcha 資料\n    getGoogleRecapcha(val) {\n      this.gCAPTCHA_token = val;\n      this.addData();\n    },\n    // 傳資料\n    addData() {\n      var me = this;\n      me.form.inv_type = me.tab + 1;\n      me.form.gCAPTCHA_token = me.gCAPTCHA_token;\n      me.form.cloudInvoice = me.cloudInvoice; //1=手動 ,2=載具 ,3=掃描\n      if (me.form.inv_type == 1) {\n        //電子發票\n        me.url = '/API/AddData_EInvoiceEnrollment/E2B1ED123CD74351911A023587A9DEE0';\n        delete me.form.buyCity; //移除購買城市\n        // 判斷是哪種輸入模式\n        switch (me.cloudInvoice) {\n          case '1':\n            //1=手動 \n            delete me.form.carrierNo; //移除載具手機條碼\n            delete me.form.verifyCode; //移除驗證碼(密碼)\n            delete me.form.scanning; //移除QR Code裡的資料\n            break;\n          case '2':\n            //,2=載具 \n            delete me.form.scanning; //移除QR Code裡的資料\n            delete me.form.inv_randomNumber; //移除隨機碼\n            break;\n          default:\n            //3=掃描\n            delete me.form.carrierNo; //移除載具手機條碼\n            delete me.form.verifyCode; //移除驗證碼(密碼)\n            delete me.form.inv_number; //發票號碼\n            delete me.form.inv_randomNumber; //隨機碼\n            delete me.form.inv_date; //發票日期\n            delete me.form.file_inv_photo; //照片\n            break;\n        }\n      } else {\n        //傳統發票\n        me.url = '/API/AddData_InvoiceEnrollment/F1F603B51C6C4EAEB3927CF7DCC51A06';\n        delete me.form.inv_randomNumber; //隨機碼\n        delete me.form.file_inv_photo; //上傳發票明細\n        delete me.form.carrierNo; //移除載具手機條碼\n        delete me.form.verifyCode; //移除驗證碼(密碼)\n        delete me.form.scanning; //移除QR Code裡的資料\n        delete me.form.carrierNo; //移除載具手機條碼\n        delete me.form.verifyCode; //移除驗證碼(密碼)\n      }\n\n      console.log('this.fff', me.form);\n      var config = {\n        method: \"post\",\n        headers: {\n          Authorization: `Bearer ${me.$accessToken}`\n        },\n        url: me.$apiUrl + me.url,\n        data: new FormData()\n      };\n      Object.keys(me.form).forEach(key => {\n        switch (key) {\n          case 'buyCity':\n            config.data.append(key, `23春風週_購買地_${me.form[key]}`);\n            break;\n          case 'buyCategory':\n            var newCategory = me.form[key].map(item => {\n              return `23春風週_${item}`;\n            });\n            config.data.append(key, JSON.stringify(newCategory));\n            break;\n          case 'gender':\n            config.data.append(key, `23春風週_性別_${me.form[key]}`);\n            break;\n          case 'liveCity':\n            config.data.append(key, `23春風週_居住地_${me.form[key]}`);\n            break;\n          default:\n            config.data.append(key, me.form[key]);\n            break;\n        }\n      });\n      swal.fire({\n        didOpen: () => {\n          swal.fire({\n            allowOutsideClick: false\n          });\n          swal.showLoading();\n          axios(config).then(res => {\n            var data = res.data;\n            console.log('data', data);\n            if (data && data.success) {\n              this.seePopUp('Check', data.data);\n            } else {\n              console.log('data', data);\n              alert(data.message);\n            }\n          }).catch(err => {\n            console.log(err);\n            alert(\"系統忙碌中，請稍後再試\");\n          }).finally(() => {\n            swal.close();\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","swal","googleRecapcha","popup","fromComponents","store","name","components","props","data","isActive","tab","parentInv_number","items","cloudInvoice","form","gCAPTCHA_token","dialog","popupIconType","popupItem","prize","inv_number","computed","fromTags","state","methods","seePopUp","val","isDraw","getParentData","console","log","googleVerify","$refs","execute","getGoogleRecapcha","addData","me","inv_type","url","buyCity","carrierNo","verifyCode","scanning","inv_randomNumber","inv_date","file_inv_photo","config","method","headers","Authorization","$accessToken","$apiUrl","FormData","Object","keys","forEach","key","append","newCategory","map","item","JSON","stringify","fire","didOpen","allowOutsideClick","showLoading","then","res","success","alert","message","catch","err","finally","close"],"sources":["src/views/fromPage.vue"],"sourcesContent":["<template>\n  <div class=\"fromPage animate__animated animate__fadeInUp animate__slow\">\n    <v-img class=\"title animate__animated animate__fadeInUp animate__slow\" contain :eager=true\n      src=\"../assets/img/gam/title.png\" width=\"0\" @load=\"$emit('getLoading', false)\" />\n    <v-tabs v-model=\"tab\" fixed-tabs>\n      <v-tab v-for=\"item in items\" :key=\"item\"\n        @click=\"$addTags(tab == 0 ? fromTags.Epaper : fromTags.paper, null, null, null)\">\n        {{ item }}\n      </v-tab>\n    </v-tabs>\n    <v-tabs-items v-model=\"tab\" @load=\"$emit('getLoading', false)\">\n      <v-tab-item>\n        <v-radio-group v-model=\"cloudInvoice\" row class=\"cloudInvoice\">\n          <v-radio label=\"手動輸入\" color=\"red\" value=\"1\"></v-radio>\n          <v-radio label=\"載具輸入\" color=\"red\" value=\"2\"></v-radio>\n          <!-- <v-radio label=\"掃描輸入\" color=\"red\" value=\"3\"></v-radio> -->\n        </v-radio-group>\n        <div class=\"textBox\">\n          <p>協助手動輸入電子發票資訊，<br>更有利加速審核發放獎項唷！</p>\n          <p v-if=\"cloudInvoice !=2 \">上傳之電子發票照片及登錄資訊須正確且能清晰辨識<br>若照片模糊、無法辨識或資格不符將喪失得獎資格</p>\n        </div>\n        <fromComponents :tab=\"tab\" @getParentData=\"getParentData\" :cloudInvoice=\"cloudInvoice\" />\n      </v-tab-item>\n      <v-tab-item>\n        <div class=\"textBox\">\n          <p>上傳之傳統發票資訊請確保正確無誤<br>如資格不符將喪失得獎資格</p>\n          <p  v-if=\"tab == 1\" style=\"font-size: 13px;text-align: center;color: #aaa;\">並請記得將傳統發票正本<br>於登錄後的七天內寄回春風活動小組<br>110 台北市信義區東興街45號9樓）</p>\n        </div>\n        <fromComponents :tab=\"tab\" @getParentData=\"getParentData\" />\n      </v-tab-item>\n    </v-tabs-items>\n    <googleRecapcha ref='googleRecapcha' @getGoogle=\"getGoogleRecapcha\"></googleRecapcha>\n    <popup :popupIconType=\"popupIconType\" :popupItem=\"popupItem\" :isDraw=\"isDraw\" :inv_number=\"inv_number\" v-if=\"dialog\"\n      @popupStatus=\"dialog=false\" />\n  </div>\n</template>\n\n<script>\n  import axios from \"axios\";\n  import swal from 'sweetalert2'\n  import googleRecapcha from '@/components/googleRecapcha.vue';\n  import popup from '../components/popup';\n  import fromComponents from '../components/fromComponents'\n  import store from '../store/tags';\n\n  export default {\n    name: 'fromPage',\n    components: {\n      popup,\n      googleRecapcha,\n      fromComponents,\n    },\n    props: [],\n    data() {\n      return {\n        isActive: '',\n        tab: null,\n        parentInv_number: '',\n        items: [\n          '電子發票', '傳統發票',\n        ],\n        cloudInvoice: '1', //1=手動 ,2=載具 ,3=掃描\n        form: '',\n        gCAPTCHA_token: '',\n        dialog: false,\n        popupIconType: '',\n        popupItem: '',\n        prize: '',\n        inv_number: '',\n      }\n    },\n    computed: {\n      fromTags() { //愛酷標籤\n        return store.state.fromTags\n      }\n    },\n    methods: {\n      // 顯示popup視窗\n      seePopUp(val, data) {\n        this.dialog = true\n        this.popupIconType = 'icon' + val\n        this.popupItem = val\n        this.isDraw = data.isDraw\n        this.inv_number = data.inv_number\n      },\n      // 拿到子層資料\n      getParentData(val) {\n        console.log('拿到子層資料', val)\n        this.form = val\n        this.googleVerify()\n      },\n      // 打googleRecapcha\n      googleVerify() {\n        this.$refs.googleRecapcha.execute();\n      },\n      // 獲得googleRecapcha 資料\n      getGoogleRecapcha(val) {\n        this.gCAPTCHA_token = val\n        this.addData()\n      },\n      // 傳資料\n      addData() {\n        var me = this;\n        me.form.inv_type = me.tab + 1\n        me.form.gCAPTCHA_token = me.gCAPTCHA_token\n        me.form.cloudInvoice = me.cloudInvoice //1=手動 ,2=載具 ,3=掃描\n        if (me.form.inv_type == 1) {\n          //電子發票\n          me.url = '/API/AddData_EInvoiceEnrollment/E2B1ED123CD74351911A023587A9DEE0'\n          delete(me.form.buyCity) //移除購買城市\n          // 判斷是哪種輸入模式\n          switch (me.cloudInvoice) {\n            case '1': //1=手動 \n              delete(me.form.carrierNo) //移除載具手機條碼\n              delete(me.form.verifyCode) //移除驗證碼(密碼)\n              delete(me.form.scanning) //移除QR Code裡的資料\n              break\n            case '2': //,2=載具 \n              delete(me.form.scanning) //移除QR Code裡的資料\n              delete(me.form.inv_randomNumber) //移除隨機碼\n              break\n            default: //3=掃描\n              delete(me.form.carrierNo) //移除載具手機條碼\n              delete(me.form.verifyCode) //移除驗證碼(密碼)\n              delete(me.form.inv_number) //發票號碼\n              delete(me.form.inv_randomNumber) //隨機碼\n              delete(me.form.inv_date) //發票日期\n              delete(me.form.file_inv_photo) //照片\n              break\n          }\n        } else {\n          //傳統發票\n          me.url = '/API/AddData_InvoiceEnrollment/F1F603B51C6C4EAEB3927CF7DCC51A06'\n          delete(me.form.inv_randomNumber) //隨機碼\n          delete(me.form.file_inv_photo) //上傳發票明細\n          delete(me.form.carrierNo) //移除載具手機條碼\n          delete(me.form.verifyCode) //移除驗證碼(密碼)\n          delete(me.form.scanning) //移除QR Code裡的資料\n          delete(me.form.carrierNo) //移除載具手機條碼\n          delete(me.form.verifyCode) //移除驗證碼(密碼)\n        }\n        console.log('this.fff', me.form)\n        var config = {\n          method: \"post\",\n          headers: {\n            Authorization: `Bearer ${me.$accessToken}`,\n          },\n          url: me.$apiUrl + me.url,\n          data: new FormData()\n        }\n        Object.keys(me.form).forEach(key => {\n          switch (key) {\n            case 'buyCity':\n              config.data.append(key, `23春風週_購買地_${me.form[key]}`);\n              break;\n            case 'buyCategory':\n              var newCategory = me.form[key].map(item => {\n                return `23春風週_${item}`;\n              })\n              config.data.append(key, JSON.stringify(newCategory));\n              break;\n            case 'gender':\n              config.data.append(key, `23春風週_性別_${me.form[key]}`);\n              break;\n            case 'liveCity':\n              config.data.append(key, `23春風週_居住地_${me.form[key]}`);\n              break;\n            default:\n              config.data.append(key, me.form[key]);\n              break;\n          }\n        });\n\n        swal.fire({\n          didOpen: () => {\n            swal.fire({\n              allowOutsideClick: false\n            });\n            swal.showLoading();\n            axios(config).then(res => {\n              var data = res.data;\n              console.log('data', data)\n              if (data && data.success) {\n                this.seePopUp('Check', data.data)\n              } else {\n                console.log('data', data)\n                alert(data.message);\n              }\n            }).catch((err) => {\n              console.log(err)\n              alert(\"系統忙碌中，請稍後再試\");\n            }).finally(() => {\n              swal.close();\n            })\n          }\n        })\n      },\n    },\n  }\n</script>\n<style lang=\"scss\">\n  #app {\n    .fromPage .primary--text {\n      color: #C35238 !important;\n      caret-color: #C35238 !important;\n    }\n  }\n\n  .fromPage {\n    padding: 30px 15px;\n\n    .container {\n      padding: 0;\n    }\n\n    .theme--light.v-tabs>.v-tabs-bar {\n      background: #ff00ff00;\n    }\n\n    .v-tab {\n      background: rgba(225, 96, 51, 0.4);\n      border-radius: 12px 12px 0 0;\n      font-size: 20px;\n      color: #ffffff !important;\n      border-right: 4px solid #C8E7ED;\n\n      &:last-child {\n        border-right: none;\n      }\n\n      &.v-tab--active {\n        background: #E16033;\n\n      }\n    }\n\n    .v-tabs-items {\n      .textBox {\n        text-align: center;\n\n        p {\n          margin: 0;\n          padding-top: 20px;\n          font-size: 16px;\n\n          &+p {\n            font-size: 12px;\n            color: #858585;\n          }\n        }\n      }\n    }\n\n    .v-input--selection-controls {\n      margin-top: 0;\n      padding-top: 20px;\n    }\n\n    .cloudInvoice .v-input--radio-group__input {\n      justify-content: space-evenly;\n    }\n\n    .v-input--selection-controls__input .v-icon {\n      color: #E7D128;\n    }\n\n    .v-window-item {\n\n      &>.v-input--radio-group,\n      &>.textBox {\n        background-color: #ffffff;\n        border-right: 3px solid #B56D21;\n      }\n    }\n  }\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}